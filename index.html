<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CÃ©lulas J&L â€” Formularios</title>
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  /* â”€â”€ NUEVA PALETA â”€â”€ */
  --ink: #f5f2ff;                    /* antes #1A1208 â€” texto principal */
  --paper: #1a0a2e;                  /* antes #FDFAF5 â€” fondo principal */
  --warm-white: #22103d;             /* antes #F7F2E8 â€” fondo cÃ¡lido secundario */
  --gold: #e8421a;                   /* antes #B8860B â€” acento principal (naranja/rojo) */
  --gold-bright: #ff7a4d;            /* antes #D4A017 â€” acento brillante */
  --gold-pale: #2a1550;              /* antes #F5EDD0 â€” fondo pÃ¡lido de chips seleccionados */
  --brown: #6b52e0;                  /* antes #6B3F1E â€” color de tÃ­tulos/botones (violeta) */
  --brown-light: #9c87ea;            /* antes #9A6240 â€” violeta claro */
  --muted: #9a96b8;                  /* antes #8A7660 â€” texto suave */
  --border: #2e1f52;                 /* antes #E2D9C8 â€” bordes */
  --border-focus: #e8421a;           /* antes #B8860B â€” borde foco (naranja) */
  --success: #3a1fc4;                /* antes #3D6B4F â€” Ã©xito (azul) */
  --danger: #c0392b;                 /* antes #8B2020 â€” peligro */
  --shadow-sm: 0 2px 8px rgba(0,0,0,0.35);
  --shadow-md: 0 8px 32px rgba(0,0,0,0.45);
  --shadow-lg: 0 20px 60px rgba(0,0,0,0.55);
  --radius: 14px;
  --radius-sm: 8px;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }

body {
  font-family: 'Plus Jakarta Sans', sans-serif;
  background: var(--paper);
  color: var(--ink);
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
}

/* Background texture */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image:
    radial-gradient(ellipse at 20% 10%, rgba(232,66,26,0.10) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 90%, rgba(107,82,224,0.12) 0%, transparent 50%);
  pointer-events: none;
  z-index: 0;
}

/* â”€â”€ HEADER â”€â”€ */
.header {
  position: sticky; top: 0; z-index: 100;
  background: rgba(26,10,46,0.92);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
  padding: 0 24px;
}
.header-inner {
  max-width: 760px; margin: 0 auto;
  display: flex; align-items: center; justify-content: space-between;
  height: 60px;
}
.logo {
  font-family: 'Lora', serif;
  font-size: 1.1rem;
  color: var(--brown-light);
  display: flex; align-items: center; gap: 10px;
}
.logo-dot {
  width: 8px; height: 8px;
  background: var(--gold);
  border-radius: 50%;
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.8); }
}

.tabs {
  display: flex; gap: 4px;
  background: var(--warm-white);
  padding: 4px; border-radius: 10px;
  border: 1px solid var(--border);
}
.tab {
  padding: 7px 18px;
  border-radius: 7px;
  border: none;
  background: transparent;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 0.82rem;
  font-weight: 600;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.2s;
  letter-spacing: 0.02em;
}
.tab.active {
  background: var(--brown);
  color: #fff;
  box-shadow: var(--shadow-sm);
}
.tab:hover:not(.active) { color: var(--brown-light); }

/* â”€â”€ PAGES â”€â”€ */
.page { display: none; position: relative; z-index: 1; }
.page.active { display: block; }

/* â”€â”€ FORM CONTAINER â”€â”€ */
.form-wrap {
  max-width: 760px; margin: 0 auto;
  padding: 48px 24px 100px;
}

/* â”€â”€ HERO â”€â”€ */
.form-hero {
  margin-bottom: 40px;
  padding-bottom: 32px;
  border-bottom: 1px solid var(--border);
}
.hero-eyebrow {
  font-size: 0.72rem;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 12px;
}
.hero-title {
  font-family: 'Lora', serif;
  font-size: clamp(1.8rem, 4vw, 2.4rem);
  color: var(--brown-light);
  line-height: 1.15;
  margin-bottom: 12px;
}
.hero-sub {
  font-size: 0.92rem;
  color: var(--muted);
  line-height: 1.7;
  max-width: 520px;
}

/* â”€â”€ PROGRESS â”€â”€ */
.progress-row {
  display: flex; align-items: center; gap: 14px;
  margin-bottom: 36px;
}
.progress-track {
  flex: 1; height: 3px;
  background: var(--border); border-radius: 3px; overflow: hidden;
}
.progress-bar {
  height: 100%; background: var(--gold);
  border-radius: 3px; transition: width 0.5s ease;
  width: 0%;
}
.progress-label {
  font-size: 0.75rem; font-weight: 700;
  color: var(--gold); min-width: 32px; text-align: right;
}

/* â”€â”€ SECTION CARD â”€â”€ */
.card {
  background: #22103d;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 28px;
  margin-bottom: 16px;
  box-shadow: var(--shadow-sm);
  transition: box-shadow 0.2s;
}
.card:hover { box-shadow: var(--shadow-md); }

.card-header {
  display: flex; align-items: center; gap: 12px;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}
.card-icon {
  width: 36px; height: 36px;
  background: var(--gold-pale);
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 1rem; flex-shrink: 0;
}
.card-title {
  font-family: 'Lora', serif;
  font-size: 1rem;
  color: var(--brown-light);
}

/* â”€â”€ FIELDS â”€â”€ */
.field { margin-bottom: 20px; }
.field:last-child { margin-bottom: 0; }

.field-row {
  display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
}
@media(max-width: 560px) { .field-row { grid-template-columns: 1fr; } }

label {
  display: block;
  font-size: 0.82rem; font-weight: 600;
  color: var(--ink);
  margin-bottom: 7px;
  letter-spacing: 0.01em;
}
.req { color: var(--gold); }
.hint {
  font-size: 0.76rem; font-weight: 400;
  color: var(--muted); margin-top: 5px; line-height: 1.5;
}

input[type=text], input[type=tel], input[type=time],
input[type=date], input[type=number], select, textarea {
  width: 100%;
  padding: 11px 14px;
  border: 1.5px solid var(--border);
  border-radius: var(--radius-sm);
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 0.88rem;
  color: var(--ink);
  background: var(--paper);
  transition: border-color 0.2s, box-shadow 0.2s, background 0.2s;
  -webkit-appearance: none;
}
input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--border-focus);
  background: #22103d;
  box-shadow: 0 0 0 3px rgba(232,66,26,0.15);
}
select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath fill='%239a96b8' d='M0 0l5 6 5-6z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 14px center;
  padding-right: 36px; cursor: pointer;
}
textarea { resize: vertical; min-height: 88px; }

/* â”€â”€ CHIPS â”€â”€ */
.chips { display: flex; flex-wrap: wrap; gap: 8px; }
.chip {
  display: flex; align-items: center; gap: 7px;
  padding: 8px 14px;
  border: 1.5px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.83rem; font-weight: 500;
  color: var(--muted);
  background: var(--paper);
  transition: all 0.18s;
  user-select: none;
}
.chip:hover { border-color: var(--gold); color: var(--ink); background: var(--gold-pale); }
.chip.on {
  border-color: var(--gold);
  background: var(--gold-pale);
  color: var(--ink);
  font-weight: 600;
}
.chip-dot {
  width: 14px; height: 14px;
  border: 2px solid var(--border);
  border-radius: 50%;
  transition: all 0.18s; flex-shrink: 0;
}
.chip.on .chip-dot { background: var(--gold); border-color: var(--gold); }
.chip.checkbox .chip-dot { border-radius: 3px; }

/* â”€â”€ CONDITIONAL â”€â”€ */
.cond { display: none; }
.cond.show { display: block; }
.cond-inline { display: none; }
.cond-inline.show { display: grid; }

/* â”€â”€ ALERT BOX â”€â”€ */
.alert-box {
  background: var(--gold-pale);
  border: 1px solid rgba(232,66,26,0.3);
  border-radius: var(--radius-sm);
  padding: 14px 16px;
  font-size: 0.83rem;
  color: var(--brown-light);
  margin-top: 12px;
  line-height: 1.6;
}

/* â”€â”€ SUBMIT â”€â”€ */
.submit-area {
  display: flex; justify-content: center;
  padding-top: 8px;
}
.btn-primary {
  background: var(--brown);
  color: #fff;
  border: none;
  padding: 15px 52px;
  border-radius: var(--radius-sm);
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 0.95rem; font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
  letter-spacing: 0.03em;
  box-shadow: 0 4px 16px rgba(107,82,224,0.35);
}
.btn-primary:hover {
  background: var(--gold);
  transform: translateY(-2px);
  box-shadow: 0 8px 28px rgba(232,66,26,0.45);
}
.btn-primary:active { transform: translateY(0); }
.btn-primary:disabled {
  background: var(--muted); cursor: not-allowed;
  transform: none; box-shadow: none;
}

/* â”€â”€ LOADING SPINNER â”€â”€ */
.spinner {
  display: inline-block;
  width: 16px; height: 16px;
  border: 2px solid rgba(255,255,255,0.4);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
  margin-right: 8px; vertical-align: middle;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â”€â”€ SUCCESS MODAL â”€â”€ */
.modal-bg {
  display: none; position: fixed; inset: 0; z-index: 200;
  background: rgba(10,5,20,0.75);
  backdrop-filter: blur(6px);
  align-items: center; justify-content: center;
}
.modal-bg.show { display: flex; }
.modal {
  background: #22103d;
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 52px 44px;
  text-align: center;
  max-width: 400px; margin: 20px;
  box-shadow: var(--shadow-lg);
  animation: popIn 0.3s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
.modal-emoji { font-size: 3.5rem; margin-bottom: 20px; }
.modal-title {
  font-family: 'Lora', serif;
  font-size: 1.5rem; color: var(--brown-light);
  margin-bottom: 10px;
}
.modal-text { color: var(--muted); font-size: 0.9rem; line-height: 1.7; margin-bottom: 28px; }
.btn-modal {
  background: var(--gold);
  color: #fff; border: none;
  padding: 12px 32px; border-radius: var(--radius-sm);
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-weight: 700; font-size: 0.9rem;
  cursor: pointer; transition: all 0.2s;
}
.btn-modal:hover { background: var(--brown); }

/* â”€â”€ EMPTY STATE â”€â”€ */
.empty-state {
  text-align: center; padding: 32px 20px;
  color: var(--muted); font-size: 0.85rem;
}

/* â”€â”€ CONFIG BANNER â”€â”€ */
.config-banner {
  background: rgba(58,31,196,0.2);
  border: 1px solid rgba(58,31,196,0.4);
  border-radius: var(--radius-sm);
  padding: 14px 18px;
  margin-bottom: 24px;
  font-size: 0.83rem;
  color: var(--brown-light);
  line-height: 1.6;
}
.config-banner strong { display: block; margin-bottom: 4px; }
</style>
</head>
<body>

<!-- â•â• HEADER â•â• -->
<header class="header">
  <div class="header-inner">
    <div class="logo">
      <div class="logo-dot"></div>
      CÃ©lulas J&amp;L
    </div>
    <div class="tabs">
      <button class="tab active" onclick="showPage('p1', this)">InscripciÃ³n</button>
      <button class="tab" onclick="showPage('p2', this)">Reporte Semanal</button>
    </div>
  </div>
</header>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- PÃGINA 1: INSCRIPCIÃ“N DE CÃ‰LULA                -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="p1" class="page active">
<div class="form-wrap">

  <div class="form-hero">
    <div class="hero-eyebrow">Formulario 1 Â· Solo una vez</div>
    <h1 class="hero-title">InscripciÃ³n<br><em>de CÃ©lula</em></h1>
    <p class="hero-sub">Registra tu cÃ©lula por primera vez. Esta informaciÃ³n quedarÃ¡ guardada y se usarÃ¡ en los reportes semanales.</p>
  </div>

  <div class="progress-row">
    <div class="progress-track"><div class="progress-bar" id="pb1"></div></div>
    <div class="progress-label" id="pl1">0%</div>
  </div>

  <!-- LÃDER -->
  <div class="card">
    <div class="card-header">
      <div class="card-icon">ğŸ‘¤</div>
      <div class="card-title">InformaciÃ³n del LÃ­der</div>
    </div>

    <div class="field-row">
      <div class="field">
        <label>Nombre completo <span class="req">*</span></label>
        <input type="text" id="i-nombre" placeholder="Tu nombre y apellido" oninput="updateProg(1)">
      </div>
      <div class="field">
        <label>WhatsApp <span class="req">*</span></label>
        <input type="tel" id="i-wa" placeholder="300 000 0000" oninput="updateProg(1)">
      </div>
    </div>

    <div class="field">
      <label>Â¿A quÃ© LÃ­der de 12 perteneces? <span class="req">*</span></label>
      <select id="i-l12" onchange="updateProg(1)">
        <option value="">â€” Selecciona tu lÃ­der de 12 â€”</option>
        <option>Ps Jhonatan y Leidy Herrera</option>
        <option>Aleja Leiva</option>
        <option>Camila PatiÃ±o</option>
        <option>Daniela Martinez</option>
        <option>Juan David Correa</option>
        <option>Manuela Giraldo</option>
        <option>Michelle Sanchez</option>
        <option>Miguel Estrada</option>
        <option>Samuel Mesa</option>
        <option>Samuel Leiva</option>
        <option>Santiago Giraldo</option>
        <option>Valentina Castrillon</option>
        <option>Wilson y Aide</option>
      </select>
    </div>

    <div class="field">
      <label>AnfitriÃ³n o Timoteo</label>
      <input type="text" id="i-colider" placeholder="Nombre del anfitriÃ³n o timoteo (opcional)">
    </div>
  </div>

  <!-- CÃ‰LULA -->
  <div class="card">
    <div class="card-header">
      <div class="card-icon">ğŸ˜ï¸</div>
      <div class="card-title">InformaciÃ³n de la CÃ©lula</div>
    </div>

    <div class="field">
      <label>Nombre de tu cÃ©lula <span style="color:var(--muted);font-weight:400">(opcional Â· solo informativo)</span></label>
      <input type="text" id="i-nombre-cel" placeholder="Ej: Familia RodrÃ­guez, Hombres Norte...">
      <p class="hint">El nombre oficial de tu cÃ©lula serÃ¡ tu nombre completo. Este campo es solo para referencia personal.</p>
    </div>

    <div class="field">
      <label>Red <span class="req">*</span></label>
      <div class="chips" id="i-red">
        <label class="chip" onclick="pick(this,'i-red',false)"><div class="chip-dot"></div>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Familias</label>
        <label class="chip" onclick="pick(this,'i-red',false)"><div class="chip-dot"></div>ğŸ‘¨ Hombres</label>
        <label class="chip" onclick="pick(this,'i-red',false)"><div class="chip-dot"></div>ğŸ‘© Mujeres</label>
        <label class="chip" onclick="pick(this,'i-red',false)"><div class="chip-dot"></div>ğŸ”¥ JÃ³venes</label>
        <label class="chip" onclick="pick(this,'i-red',false)"><div class="chip-dot"></div>ğŸ’ Teens</label>
        <label class="chip" onclick="pick(this,'i-red',false)"><div class="chip-dot"></div>ğŸŒŸ Kids</label>
      </div>
    </div>

    <div class="field-row">
      <div class="field">
        <label>Tipo de cÃ©lula <span class="req">*</span></label>
        <div class="chips" id="i-tipo">
          <label class="chip" onclick="pick(this,'i-tipo',false)"><div class="chip-dot"></div>ğŸ“– Discipulado</label>
          <label class="chip" onclick="pick(this,'i-tipo',false)"><div class="chip-dot"></div>ğŸŒ EvangelÃ­stica</label>
        </div>
      </div>
      <div class="field">
        <label>Modalidad habitual <span class="req">*</span></label>
        <div class="chips" id="i-modalidad">
          <label class="chip" onclick="pick(this,'i-modalidad',false)"><div class="chip-dot"></div>ğŸ  Presencial</label>
          <label class="chip" onclick="pick(this,'i-modalidad',false)"><div class="chip-dot"></div>ğŸ’» Virtual</label>
          <label class="chip" onclick="pick(this,'i-modalidad',false)"><div class="chip-dot"></div>ğŸ”€ HÃ­brida</label>
        </div>
      </div>
    </div>
  </div>

  <!-- LOGÃSTICA -->
  <div class="card">
    <div class="card-header">
      <div class="card-icon">ğŸ“</div>
      <div class="card-title">LogÃ­stica y UbicaciÃ³n</div>
    </div>

    <div class="field">
      <label>DÃ­as de reuniÃ³n <span class="req">*</span></label>
      <div class="chips" id="i-dias">
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>Lun</label>
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>Mar</label>
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>MiÃ©</label>
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>Jue</label>
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>Vie</label>
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>SÃ¡b</label>
        <label class="chip checkbox" onclick="pick(this,'i-dias',true)"><div class="chip-dot"></div>Dom</label>
      </div>
    </div>

    <div class="field-row">
      <div class="field">
        <label>Hora de inicio <span class="req">*</span></label>
        <input type="time" id="i-hora" onchange="updateProg(1)">
      </div>
      <div class="field">
        <label>Comuna <span class="req">*</span></label>
        <select id="i-comuna" onchange="updateProg(1)">
          <option value="">â€” Selecciona â€”</option>
          <optgroup label="MedellÃ­n â€” Comunas">
          <option>Popular (1)</option><option>Santa Cruz (2)</option>
          <option>Manrique (3)</option><option>Aranjuez (4)</option>
          <option>Castilla (5)</option><option>Doce de Octubre (6)</option>
          <option>Robledo (7)</option><option>Villa Hermosa (8)</option>
          <option>Buenos Aires (9)</option><option>La Candelaria (10)</option>
          <option>Laureles-Estadio (11)</option><option>La AmÃ©rica (12)</option>
          <option>San Javier (13)</option><option>El Poblado (14)</option>
          <option>Guayabal (15)</option><option>BelÃ©n (16)</option>
          </optgroup>
          <optgroup label="MedellÃ­n â€” Corregimientos">
          <option>Corregimiento San SebastiÃ¡n de Palmitas</option>
          <option>Corregimiento San CristÃ³bal</option>
          <option>Corregimiento Altavista</option>
          <option>Corregimiento San Antonio de Prado</option>
          <option>Corregimiento Santa Elena</option>
          </optgroup>
          <optgroup label="Ãrea Metropolitana">
          <option>Bello</option>
          <option>Envigado</option>
          <option>Sabaneta</option>
          <option>ItagÃ¼Ã­</option>
          <option>Caldas</option>
          </optgroup>
          <option>Otro municipio</option>
        </select>
      </div>
    </div>

    <div class="field-row">
      <div class="field">
        <label>Barrio</label>
        <input type="text" id="i-barrio" placeholder="Nombre del barrio">
      </div>
      <div class="field">
        <label>DirecciÃ³n aproximada</label>
        <input type="text" id="i-dir" placeholder="Ej: Cra 45 # 60-20">
        <p class="hint">Para el mapa, no necesita ser exacta</p>
      </div>
    </div>
  </div>

  <div class="submit-area">
    <button class="btn-primary" id="btn-inscribir" onclick="enviarInscripcion()">
      Inscribir mi CÃ©lula
    </button>
  </div>

</div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- PÃGINA 2: REPORTE SEMANAL                      -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="p2" class="page">
<div class="form-wrap">

  <div class="form-hero">
    <div class="hero-eyebrow">Formulario 2 Â· Cada semana</div>
    <h1 class="hero-title">Reporte<br><em>Semanal</em></h1>
    <p class="hero-sub">Llena este formulario despuÃ©s de cada cÃ©lula. Menos de 2 minutos y nos ayuda a ver cÃ³mo crece el reino en MedellÃ­n.</p>
  </div>

  <div class="progress-row">
    <div class="progress-track"><div class="progress-bar" id="pb2"></div></div>
    <div class="progress-label" id="pl2">0%</div>
  </div>

  <!-- IDENTIFICACIÃ“N -->
  <div class="card">
    <div class="card-header">
      <div class="card-icon">ğŸ”</div>
      <div class="card-title">Â¿QuiÃ©n reporta?</div>
    </div>

    <div class="field">
      <label>Â¿A quÃ© LÃ­der de 12 perteneces? <span class="req">*</span></label>
      <select id="r-l12" onchange="filtrarLideres(); updateProg(2)">
        <option value="">â€” Primero selecciona tu lÃ­der de 12 â€”</option>
        <option>Ps Jhonatan y Leidy Herrera</option>
        <option>Aleja Leiva</option>
        <option>Camila PatiÃ±o</option>
        <option>Daniela Martinez</option>
        <option>Juan David Correa</option>
        <option>Manuela Giraldo</option>
        <option>Michelle Sanchez</option>
        <option>Miguel Estrada</option>
        <option>Samuel Mesa</option>
        <option>Samuel Leiva</option>
        <option>Santiago Giraldo</option>
        <option>Valentina Castrillon</option>
        <option>Wilson y Aide</option>
      </select>
    </div>

    <div class="field" id="r-lider-wrap" style="display:none">
      <label>Tu nombre (lÃ­der de cÃ©lula) <span class="req">*</span></label>
      <select id="r-lider" onchange="updateProg(2)">
        <option value="">â€” Selecciona tu nombre â€”</option>
      </select>
      <p class="hint">Solo aparecen los lÃ­deres inscritos bajo tu ministerio</p>
    </div>

    <div class="field">
      <label>Fecha de la cÃ©lula <span class="req">*</span></label>
      <input type="date" id="r-fecha" onchange="updateProg(2)">
    </div>
  </div>

  <!-- Â¿SE REALIZÃ“? -->
  <div class="card">
    <div class="card-header">
      <div class="card-icon">âœ…</div>
      <div class="card-title">Â¿Se realizÃ³ la cÃ©lula?</div>
    </div>

    <div class="field">
      <div class="chips" id="r-realizada">
        <label class="chip" onclick="pick(this,'r-realizada',false); toggleRealizada('si')"><div class="chip-dot"></div>âœ… SÃ­ se realizÃ³</label>
        <label class="chip" onclick="pick(this,'r-realizada',false); toggleRealizada('no')"><div class="chip-dot"></div>âŒ No se realizÃ³</label>
      </div>
    </div>

    <!-- NO se realizÃ³ -->
    <div class="cond" id="blk-no">
      <div class="field">
        <label>Â¿Por quÃ© no se realizÃ³? <span class="req">*</span></label>
        <select id="r-motivo">
          <option value="">â€” Selecciona un motivo â€”</option>
          <option>Semana de descanso programada</option>
          <option>Problemas de salud del lÃ­der</option>
          <option>Problemas de salud de los miembros</option>
          <option>Viaje o ausencia del lÃ­der</option>
          <option>DÃ­a festivo</option>
          <option>Bajo quÃ³rum esperado</option>
          <option>Otro</option>
        </select>
      </div>
      <div class="field">
        <label>Â¿CuÃ¡ndo serÃ¡ la prÃ³xima cÃ©lula?</label>
        <input type="date" id="r-proxima">
      </div>
    </div>

    <!-- SÃ se realizÃ³ -->
    <div class="cond" id="blk-si">
      <div class="field-row cond-inline" id="blk-si-row" style="display:none">
        <div class="field">
          <label>Modalidad esta semana <span class="req">*</span></label>
          <div class="chips" id="r-modalidad">
            <label class="chip" onclick="pick(this,'r-modalidad',false)"><div class="chip-dot"></div>ğŸ  Presencial</label>
            <label class="chip" onclick="pick(this,'r-modalidad',false)"><div class="chip-dot"></div>ğŸ’» Virtual</label>
          </div>
        </div>
        <div class="field">
          <label>Tipo esta semana <span class="req">*</span></label>
          <div class="chips" id="r-tipo">
            <label class="chip" onclick="pick(this,'r-tipo',false)"><div class="chip-dot"></div>ğŸ“– Discipulado</label>
            <label class="chip" onclick="pick(this,'r-tipo',false)"><div class="chip-dot"></div>ğŸŒ EvangelÃ­stica</label>
          </div>
        </div>
      </div>
      <div class="field-row">
        <div class="field">
          <label>DÃ­a de la semana <span class="req">*</span></label>
          <select id="r-dia">
            <option value="">â€” DÃ­a â€”</option>
            <option>Lunes</option><option>Martes</option><option>MiÃ©rcoles</option>
            <option>Jueves</option><option>Viernes</option><option>SÃ¡bado</option><option>Domingo</option>
          </select>
        </div>
        <div class="field">
          <label>Hora de inicio <span class="req">*</span></label>
          <input type="time" id="r-hora">
        </div>
      </div>
    </div>
  </div>

  <!-- ASISTENCIA -->
  <div class="card cond" id="blk-asistencia">
    <div class="card-header">
      <div class="card-icon">ğŸ‘¥</div>
      <div class="card-title">Asistencia</div>
    </div>

    <div class="field-row">
      <div class="field">
        <label>Total asistentes <span class="req">*</span></label>
        <input type="number" id="r-total" min="0" placeholder="0">
      </div>
      <div class="field">
        <label>Visitantes nuevos <span class="req">*</span></label>
        <input type="number" id="r-nuevos" min="0" placeholder="0">
      </div>
    </div>
    <div class="field">
      <label>Miembros que fueron a S1 este fin de semana <span class="req">*</span></label>
      <input type="number" id="r-iglesia" min="0" placeholder="0">
    </div>
  </div>

  <!-- CONTENIDO -->
  <div class="card cond" id="blk-contenido">
    <div class="card-header">
      <div class="card-icon">ğŸ“</div>
      <div class="card-title">Contenido</div>
    </div>

    <div class="field">
      <label>Tema dado en la cÃ©lula <span class="req">*</span></label>
      <input type="text" id="r-tema" placeholder="Ej: El amor de Dios, Identidad en Cristo...">
    </div>

    <div class="field">
      <label>Material utilizado <span class="req">*</span></label>
      <div class="chips" id="r-material">
        <label class="chip" onclick="pick(this,'r-material',false); toggleMaterial('iglesia')"><div class="chip-dot"></div>â›ª Material de la iglesia</label>
        <label class="chip" onclick="pick(this,'r-material',false); toggleMaterial('otro')"><div class="chip-dot"></div>ğŸ“š Otro</label>
      </div>
    </div>

    <div class="field cond" id="blk-otro-mat">
      <label>Â¿CuÃ¡l material? <span class="req">*</span></label>
      <input type="text" id="r-otro-mat" placeholder="Nombre del libro, serie, predicador...">
    </div>
  </div>

  <!-- NOTAS -->
  <div class="card cond" id="blk-notas">
    <div class="card-header">
      <div class="card-icon">ğŸ™</div>
      <div class="card-title">Peticiones y Notas</div>
    </div>
    <div class="field">
      <label>Peticiones de oraciÃ³n o novedades</label>
      <textarea id="r-notas" placeholder="Comparte necesidades de oraciÃ³n, testimonios o cualquier novedad..."></textarea>
      <p class="hint">Opcional Â· Solo lo ven lÃ­deres y pastores</p>
    </div>
  </div>

  <div class="submit-area cond" id="blk-submit">
    <button class="btn-primary" id="btn-reportar" onclick="enviarReporte()">
      Enviar Reporte
    </button>
  </div>

</div>
</div>


<!-- SUCCESS MODAL -->
<div class="modal-bg" id="modal">
  <div class="modal">
    <div class="modal-emoji" id="modal-emoji">ğŸ‰</div>
    <h2 class="modal-title" id="modal-title">Â¡Listo!</h2>
    <p class="modal-text" id="modal-text">Todo guardado correctamente.</p>
    <button class="btn-modal" onclick="closeModal()">Entendido</button>
  </div>
</div>


<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIGURACIÃ“N â€” PEGA AQUÃ LA URL DE TU APPS SCRIPT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const BACKEND_URL = "https://script.google.com/macros/s/AKfycbzhgKbbt2J40z6P00Hq9yllzHdE5hRodsIGXmp2jP1PNBoa_WgcQ171CRGLQ9Pj5Co7yQ/exec";
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Mapa de lÃ­deres cargado desde el backend
let mapaLideres = {};

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('r-fecha').valueAsDate = new Date();
  cargarLideres();
});

// â”€â”€ CARGAR LÃDERES DESDE GOOGLE SHEETS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function cargarLideres() {
  if (BACKEND_URL === "PEGA_AQUÃ_LA_URL_DE_TU_APPS_SCRIPT_WEB_APP") return;
  try {
    const res = await fetch(BACKEND_URL + "?action=getLideres");
    const json = await res.json();
    if (json.success) {
      mapaLideres = json.data;
    }
  } catch(e) {
    console.warn("No se pudieron cargar lÃ­deres:", e);
  }
}

// â”€â”€ FILTRAR LÃDERES EN REPORTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function filtrarLideres() {
  const l12 = document.getElementById('r-l12').value;
  const wrap = document.getElementById('r-lider-wrap');
  const sel  = document.getElementById('r-lider');

  if (!l12) { wrap.style.display = 'none'; return; }

  sel.innerHTML = '<option value="">â€” Selecciona tu nombre â€”</option>';
  const lideres = mapaLideres[l12] || [];

  if (lideres.length === 0) {
    sel.innerHTML += '<option disabled>No hay lÃ­deres inscritos aÃºn en este ministerio</option>';
  } else {
    lideres.sort().forEach(n => {
      const opt = document.createElement('option');
      opt.value = n; opt.textContent = n;
      sel.appendChild(opt);
    });
  }
  wrap.style.display = 'block';
}

// â”€â”€ CHIP SELECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function pick(el, groupId, multi) {
  if (!multi) {
    document.querySelectorAll(`#${groupId} .chip`).forEach(c => c.classList.remove('on'));
  }
  el.classList.toggle('on');
  updateProg(1); updateProg(2);
}

function getChips(groupId) {
  return [...document.querySelectorAll(`#${groupId} .chip.on`)]
    .map(c => c.textContent.trim().replace(/^[^\w]+/, '').trim());
}
function getChip(groupId) { return getChips(groupId)[0] || ""; }

// â”€â”€ TOGGLE REALIZADA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleRealizada(val) {
  const blkNo  = document.getElementById('blk-no');
  const blkSi  = document.getElementById('blk-si');
  const blkSiRow = document.getElementById('blk-si-row');
  const others = ['blk-asistencia','blk-contenido','blk-notas','blk-submit'];

  if (val === 'no') {
    blkNo.classList.add('show');
    blkSi.classList.remove('show');
    blkSiRow.style.display = 'none';
    others.forEach(id => document.getElementById(id).classList.remove('show'));
  } else {
    blkNo.classList.remove('show');
    blkSi.classList.add('show');
    blkSiRow.style.display = 'grid';
    others.forEach(id => document.getElementById(id).classList.add('show'));
  }
  updateProg(2);
}

// â”€â”€ TOGGLE MATERIAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleMaterial(val) {
  document.getElementById('blk-otro-mat').classList.toggle('show', val === 'otro');
}

// â”€â”€ CALCULAR ASISTENCIA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcAsistencia() {
  const total = parseInt(document.getElementById('r-total').value) || 0;
  const reg   = parseInt(document.getElementById('r-regulares').value) || 0;
  const hint  = document.getElementById('calc-hint');
  if (total > 0 && reg <= total) {
    hint.textContent = `âœ“ Visitantes esperados: ${total - reg}`;
  } else {
    hint.textContent = '';
  }
}

// â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateProg(form) {
  if (form === 1) {
    const filled = [
      document.getElementById('i-nombre').value,
      document.getElementById('i-wa').value,
      document.getElementById('i-l12').value,
      document.getElementById('i-hora').value,
      document.getElementById('i-comuna').value,
      getChip('i-red'),
      getChip('i-tipo'),
      getChip('i-modalidad'),
      getChips('i-dias').length > 0 ? 'x' : '',
    ].filter(Boolean).length;
    const pct = Math.round((filled / 9) * 100);
    document.getElementById('pb1').style.width = pct + '%';
    document.getElementById('pl1').textContent = pct + '%';
  } else {
    const filled = [
      document.getElementById('r-l12').value,
      document.getElementById('r-lider').value,
      document.getElementById('r-fecha').value,
      getChip('r-realizada'),
    ].filter(Boolean).length;
    const pct = Math.min(100, Math.round((filled / 4) * 100));
    document.getElementById('pb2').style.width = pct + '%';
    document.getElementById('pl2').textContent = pct + '%';
  }
}

// â”€â”€ ENVIAR INSCRIPCIÃ“N â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function enviarInscripcion() {
  const nombre = document.getElementById('i-nombre').value.trim();
  const wa     = document.getElementById('i-wa').value.trim();
  const l12    = document.getElementById('i-l12').value;
  const cel    = document.getElementById('i-nombre-cel').value.trim();
  const hora   = document.getElementById('i-hora').value;
  const comuna = document.getElementById('i-comuna').value;
  const red    = getChip('i-red');
  const tipo   = getChip('i-tipo');
  const mod    = getChip('i-modalidad');
  const dias   = getChips('i-dias');

  if (!nombre || !wa || !l12 || !hora || !comuna || !red || !tipo || !mod || !dias.length) {
    alert('Por favor completa todos los campos obligatorios (marcados con *)');
    return;
  }

  const data = {
    action: "inscripcion",
    nombreLider: nombre,
    whatsapp: wa,
    lider12: l12,
    coLider: document.getElementById('i-colider').value.trim(),
    nombreCelula: cel,
    red, tipo, modalidad: mod, dias, hora, comuna,
    barrio: document.getElementById('i-barrio').value.trim(),
    direccion: document.getElementById('i-dir').value.trim()
  };

  await enviar(data, 'btn-inscribir',
    'ğŸ‰', 'Â¡CÃ©lula inscrita!',
    'Tu cÃ©lula quedÃ³ registrada. Ya puedes llenar el reporte semanal cada semana.'
  );

  await cargarLideres();
}

// â”€â”€ ENVIAR REPORTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function enviarReporte() {
  const l12    = document.getElementById('r-l12').value;
  const lider  = document.getElementById('r-lider').value;
  const fecha  = document.getElementById('r-fecha').value;
  const real   = getChip('r-realizada');

  if (!l12 || !lider || !fecha || !real) {
    alert('Por favor completa los campos de identificaciÃ³n y si se realizÃ³ la cÃ©lula.');
    return;
  }

  const data = {
    action: "reporte",
    lider12: l12,
    nombreLider: lider,
    fechaCelula: fecha,
    seRealizo: real,
    motivoNoRealizada: document.getElementById('r-motivo').value,
    proximaFecha: document.getElementById('r-proxima').value,
    modalidad: getChip('r-modalidad'),
    tipoReunion: getChip('r-tipo'),
    diaSemana: document.getElementById('r-dia').value,
    hora: document.getElementById('r-hora').value,
    totalAsistentes: document.getElementById('r-total').value || 0,
    visitantesNuevos: document.getElementById('r-nuevos').value || 0,
    asisitieronIglesia: document.getElementById('r-iglesia').value || 0,
    tema: document.getElementById('r-tema').value.trim(),
    material: getChip('r-material'),
    otroMaterial: document.getElementById('r-otro-mat').value.trim(),
    peticiones: document.getElementById('r-notas').value.trim()
  };

  await enviar(data, 'btn-reportar',
    'ğŸ™', 'Â¡Reporte enviado!',
    'Gracias por reportar. Tu fidelidad ayuda a ver cÃ³mo crece el reino en MedellÃ­n.'
  );
}

// â”€â”€ ENVIAR AL BACKEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function enviar(data, btnId, emoji, titulo, texto) {
  const btn = document.getElementById(btnId);
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span>Guardando...';

  if (BACKEND_URL === "PEGA_AQUÃ_LA_URL_DE_TU_APPS_SCRIPT_WEB_APP") {
    await new Promise(r => setTimeout(r, 1200));
    showModal(emoji, titulo, texto + '\n\nâš ï¸ Modo demo: conecta el backend para guardar en Google Sheets.');
    btn.disabled = false;
    btn.textContent = btnId === 'btn-inscribir' ? 'Inscribir mi CÃ©lula' : 'Enviar Reporte';
    return;
  }

  try {
    const res = await fetch(BACKEND_URL, {
      method: 'POST',
      body: JSON.stringify(data)
    });
    const json = await res.json();
    if (json.success) {
      showModal(emoji, titulo, texto);
    } else {
      alert('Error al guardar: ' + (json.error || 'Error desconocido'));
    }
  } catch(e) {
    alert('Error de conexiÃ³n. Verifica la URL del backend.');
  }

  btn.disabled = false;
  btn.textContent = btnId === 'btn-inscribir' ? 'Inscribir mi CÃ©lula' : 'Enviar Reporte';
}

// â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showModal(emoji, titulo, texto) {
  document.getElementById('modal-emoji').textContent = emoji;
  document.getElementById('modal-title').textContent = titulo;
  document.getElementById('modal-text').textContent = texto;
  document.getElementById('modal').classList.add('show');
}
function closeModal() {
  document.getElementById('modal').classList.remove('show');
}

// â”€â”€ TAB NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPage(pageId, btn) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(pageId).classList.add('active');
  btn.classList.add('active');
}
</script>
</body>
</html>